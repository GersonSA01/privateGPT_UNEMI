import sys
from qdrant_client import QdrantClient
from qdrant_client.http.models import Distance, VectorParams

# CONFIGURACI√ìN
# ¬°IMPORTANTE! Cambia esto seg√∫n tu modelo de embeddings.
# OpenAI = 1536, Nomic = 768, Local default = 1024 o 384.
VECTOR_SIZE = 768  
COLLECTION_NAME = "make_this_parameterizable_per_api_call" # Nombre por defecto de PrivateGPT

def resetear():
    try:
        print("üîå Conectando a Qdrant...")
        client = QdrantClient(url="http://localhost:6333")
    except Exception as e:
        print(f"‚ùå Error: {e}")
        sys.exit(1)

    # 1. BORRAR SI EXISTE
    if client.collection_exists(COLLECTION_NAME):
        print(f"üóëÔ∏è  Borrando colecci√≥n '{COLLECTION_NAME}'...")
        client.delete_collection(COLLECTION_NAME)
    else:
        print(f"‚ö†Ô∏è La colecci√≥n '{COLLECTION_NAME}' no exist√≠a.")

    # 2. RECREAR VAC√çA
    print(f"‚ú® Creando colecci√≥n '{COLLECTION_NAME}' vac√≠a (Dim: {VECTOR_SIZE})...")
    
    client.create_collection(
        collection_name=COLLECTION_NAME,
        vectors_config=VectorParams(size=VECTOR_SIZE, distance=Distance.COSINE),
    )

    print("‚úÖ ¬°Listo! Base de datos reiniciada. No necesitas reiniciar Docker.")

if __name__ == "__main__":
    resetear()